import{a as l,b as v,c as b,d as N,e as C,f as z,g as k,h as u}from"/build/_shared/chunk-4TU7APBU.js";import{c as r}from"/build/_shared/chunk-MGHLVMKF.js";import{a as T}from"/build/_shared/chunk-LV3DFGJF.js";import"/build/_shared/chunk-AMZSOOKO.js";import"/build/_shared/chunk-NKGL3J4W.js";import{l as I,m as E,q as L}from"/build/_shared/chunk-LU4WXESO.js";import{h as S}from"/build/_shared/chunk-GSPLIXRC.js";import{a as q,b as P}from"/build/_shared/chunk-F33EF4G7.js";import{d as f}from"/build/_shared/chunk-2QEWK57A.js";var i=f(q(),1);var e=f(P(),1);function B(){let[F,O]=(0,i.useState)([]),[j,w]=(0,i.useState)(!0),[D,H]=(0,i.useState)(""),[s,U]=S(),[d,A]=(0,i.useState)(Number(s.get("page"))||1),[g,R]=(0,i.useState)(Number(s.get("pageSize"))||10),[n,o]=(0,i.useState)(null),[h,c]=(0,i.useState)(null),p=async()=>{w(!0);try{let a=await(await fetch("http://localhost:5055/api/v1/institution",{credentials:"include"})).json();O(a)}catch(t){console.error("Error al cargar instituciones",t)}finally{w(!1)}},G=async()=>{if(!n)return;let t=n.id?"PUT":"POST",a=(n.id,"http://localhost:5055/api/v1/institution"),m=JSON.stringify(n);try{(await fetch(a,{method:t,headers:{"Content-Type":"application/json"},credentials:"include",body:m})).ok?(p(),o(null)):console.error("Error al guardar instituci\xF3n")}catch(y){console.error("Error en la petici\xF3n",y)}},J=async()=>{if(h)try{await fetch(`http://localhost:5055/api/v1/institution/${h}`,{method:"DELETE",credentials:"include"}),c(null),p()}catch(t){console.error("Error al eliminar instituci\xF3n",t)}};(0,i.useEffect)(()=>{p()},[]);let x=F.filter(t=>t.name.toLowerCase().includes(D.toLowerCase())),$=x.slice((d-1)*g,d*g);return(0,i.useEffect)(()=>{let t=Number(s.get("pageSize"))||10;R(t)},[s]),(0,e.jsxs)("div",{children:[j?(0,e.jsx)("p",{className:"text-4xl",children:"Cargando instituciones..."}):(0,e.jsxs)(e.Fragment,{children:[(0,e.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,e.jsxs)(r,{onClick:()=>o({name:"",image:"",link:""}),className:"flex gap-2 items-center",children:[(0,e.jsx)(E,{size:18})," Nueva"]}),(0,e.jsx)(l,{placeholder:"Buscar por nombre...",value:D,onChange:t=>H(t.target.value),className:"w-1/2"})]}),(0,e.jsx)("div",{className:"overflow-auto",children:(0,e.jsxs)("table",{className:"min-w-full bg-white dark:bg-neutral-600 rounded shadow",children:[(0,e.jsx)("thead",{className:"bg-gray-100",children:(0,e.jsxs)("tr",{className:"dark:text-black",children:[(0,e.jsx)("th",{className:"p-2 text-left w-1/3",children:"Nombre"}),(0,e.jsx)("th",{className:"p-2 text-left w-1/3",children:"Link"}),(0,e.jsx)("th",{className:"p-2 text-right w-1/3",children:"Acciones"})]})}),(0,e.jsx)("tbody",{children:$.map(t=>(0,e.jsxs)("tr",{className:"border-t",children:[(0,e.jsx)("td",{className:"p-2 text-left w-1/6",children:t.name}),(0,e.jsx)("td",{className:"p-2 text-left w-1/3 truncate max-w-[250px]",title:t.link,children:t.link}),(0,e.jsx)("td",{className:"p-2 text-right w-1/3",children:(0,e.jsxs)("div",{className:"flex justify-end gap-2",children:[(0,e.jsx)(r,{variant:"outline",size:"sm",onClick:()=>o(t),children:(0,e.jsx)(I,{size:16})}),(0,e.jsx)(r,{variant:"destructive",size:"sm",onClick:()=>c(t.id),children:(0,e.jsx)(L,{size:16})})]})})]},t.id))})]})})]}),(0,e.jsx)(T,{currentPage:d,totalItems:x.length,pageSize:g,onPageChange:t=>{A(t),U(a=>{let m=new URLSearchParams(a);return m.set("page",String(t)),m})}}),(0,e.jsx)(v,{open:!!n,onOpenChange:()=>o(null),children:(0,e.jsxs)(b,{className:"max-h-[90vh] overflow-auto max-w-[40rem]",children:[(0,e.jsx)(N,{children:(0,e.jsx)(C,{children:n?.id?"Editar Instituci\xF3n":"Nueva Instituci\xF3n"})}),(0,e.jsxs)("form",{className:"space-y-4",children:[(0,e.jsxs)("div",{children:[(0,e.jsx)(u,{htmlFor:"name",children:"Nombre"}),(0,e.jsx)(l,{id:"name",name:"name",value:n?.name||"",onChange:t=>o(a=>({...a,name:t.target.value}))})]}),(0,e.jsxs)("div",{children:[(0,e.jsx)(u,{htmlFor:"image",children:"URL de Imagen"}),(0,e.jsx)(l,{id:"image",name:"image",value:n?.image||"",onChange:t=>o(a=>({...a,image:t.target.value}))})]}),(0,e.jsxs)("div",{children:[(0,e.jsx)(u,{htmlFor:"link",children:"Link"}),(0,e.jsx)(l,{id:"link",name:"link",value:n?.link||"",onChange:t=>o(a=>({...a,link:t.target.value}))})]})]}),(0,e.jsxs)(k,{children:[(0,e.jsx)(r,{variant:"outline",onClick:()=>o(null),children:"Cancelar"}),(0,e.jsx)(r,{onClick:G,children:"Guardar"})]})]})}),(0,e.jsx)(v,{open:!!h,onOpenChange:()=>c(null),children:(0,e.jsxs)(b,{"aria-describedby":"delete-institution-description",children:[(0,e.jsxs)(N,{children:[(0,e.jsx)(C,{children:"\xBFEliminar instituci\xF3n?"}),(0,e.jsx)(z,{id:"delete-institution-description",children:"Esta acci\xF3n es irreversible. \xBFDeseas continuar?"})]}),(0,e.jsxs)(k,{children:[(0,e.jsx)(r,{onClick:()=>c(null),variant:"outline",children:"Cancelar"}),(0,e.jsx)(r,{onClick:J,variant:"destructive",children:"Eliminar"})]})]})})]})}export{B as default};
