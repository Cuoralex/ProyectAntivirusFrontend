import{a as v,b as f,c as y,d as b,e as D,f as B,g as N,h as C}from"/build/_shared/chunk-JB55QAS3.js";import{c as o}from"/build/_shared/chunk-MGHLVMKF.js";import{a as L}from"/build/_shared/chunk-2MFZW4W2.js";import"/build/_shared/chunk-AMZSOOKO.js";import"/build/_shared/chunk-NKGL3J4W.js";import{l as k,m as E,q as z}from"/build/_shared/chunk-LU4WXESO.js";import{h as x}from"/build/_shared/chunk-2IM6IZL7.js";import{a as K,b as P}from"/build/_shared/chunk-F33EF4G7.js";import{d as h}from"/build/_shared/chunk-2QEWK57A.js";var a=h(K(),1);var e=h(P(),1);function F(){let[I,O]=(0,a.useState)([]),[j,S]=(0,a.useState)(!0),[r,n]=(0,a.useState)(null),[p,s]=(0,a.useState)(null),[T,H]=(0,a.useState)(""),[l,$]=x(),[m,A]=(0,a.useState)(Number(l.get("page"))||1),[u,U]=(0,a.useState)(Number(l.get("pageSize"))||10),g=async()=>{S(!0);try{let i=await(await fetch("http://localhost:5055/api/serviceTypes",{credentials:"include"})).json();O(i)}catch(t){console.error("Error al cargar tipos de servicio",t)}finally{S(!1)}},G=async()=>{if(!r)return;let t=r.id?"PUT":"POST",i=r.id?`http://localhost:5055/api/serviceTypes/${r.id}`:"http://localhost:5055/api/serviceTypes",c=JSON.stringify(r);try{let d=await fetch(i,{method:t,headers:{"Content-Type":"application/json"},credentials:"include",body:c});if(d.ok)g(),n(null);else{let q=await d.json();console.error("Error al guardar tipo de servicio",q)}}catch(d){console.error("Error en la petici\xF3n",d)}},J=async()=>{if(p)try{await fetch(`http://localhost:5055/api/serviceTypes/${p}`,{method:"DELETE",credentials:"include"}),s(null),g()}catch(t){console.error("Error al eliminar tipo de servicio",t)}};(0,a.useEffect)(()=>{g()},[]);let w=I.filter(t=>t.name.toLowerCase().includes(T.toLowerCase())),R=w.slice((m-1)*u,m*u);return(0,a.useEffect)(()=>{let t=Number(l.get("pageSize"))||10;U(t)},[l]),(0,e.jsxs)("div",{children:[j?(0,e.jsx)("p",{className:"text-4xl",children:"Cargando tipos de servicio..."}):(0,e.jsxs)(e.Fragment,{children:[(0,e.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,e.jsxs)(o,{onClick:()=>n({name:"",description:""}),className:"flex gap-2 items-center",children:[(0,e.jsx)(E,{size:18})," Nuevo"]}),(0,e.jsx)(v,{placeholder:"Buscar por nombre...",value:T,onChange:t=>H(t.target.value),className:"w-1/2"})]}),(0,e.jsx)("div",{className:"overflow-auto",children:(0,e.jsxs)("table",{className:"min-w-full bg-white rounded shadow dark:bg-neutral-600  ",children:[(0,e.jsx)("thead",{className:"bg-gray-100",children:(0,e.jsxs)("tr",{className:"dark:text-black",children:[(0,e.jsx)("th",{className:"p-2 text-left",children:"Nombre"}),(0,e.jsx)("th",{className:"p-2 text-left",children:"Descripci\xF3n"}),(0,e.jsx)("th",{className:"p-2 text-left",children:"Acciones"})]})}),(0,e.jsx)("tbody",{children:R.map(t=>(0,e.jsxs)("tr",{className:"border-t",children:[(0,e.jsx)("td",{className:"p-2 text-left",children:t.name}),(0,e.jsx)("td",{className:"p-2 text-left",children:t.description?t.description.length>60?`${t.description.slice(0,60)}...`:t.description:"Sin descripci\xF3n"}),(0,e.jsxs)("td",{className:"p-2 flex gap-2",children:[(0,e.jsx)(o,{variant:"outline",size:"sm",onClick:()=>n(t),children:(0,e.jsx)(k,{size:16})}),(0,e.jsx)(o,{variant:"destructive",size:"sm",onClick:()=>s(t.id),children:(0,e.jsx)(z,{size:16})})]})]},t.id))})]})})]}),(0,e.jsx)(L,{currentPage:m,totalItems:w.length,pageSize:u,onPageChange:t=>{A(t),$(i=>{let c=new URLSearchParams(i);return c.set("page",String(t)),c})}}),(0,e.jsx)(f,{open:!!r,onOpenChange:()=>n(null),children:(0,e.jsxs)(y,{className:"max-w-md",children:[(0,e.jsx)(b,{children:(0,e.jsx)(D,{children:r?.id?"Editar Tipo":"Nuevo Tipo de Servicio"})}),(0,e.jsxs)("form",{className:"space-y-4",children:[(0,e.jsxs)("div",{children:[(0,e.jsx)(C,{htmlFor:"name",children:"Nombre"}),(0,e.jsx)(v,{id:"name",value:r?.name||"",onChange:t=>n(i=>({...i,name:t.target.value}))})]}),(0,e.jsxs)("div",{children:[(0,e.jsx)(C,{htmlFor:"description",children:"Descripci\xF3n"}),(0,e.jsx)("textarea",{id:"description",rows:4,className:"w-full border border-gray-300 rounded p-2 bg-white",value:r?.description||"",onChange:t=>n(i=>({...i,description:t.target.value}))})]})]}),(0,e.jsxs)(N,{children:[(0,e.jsx)(o,{variant:"outline",onClick:()=>n(null),children:"Cancelar"}),(0,e.jsx)(o,{onClick:G,children:"Guardar"})]})]})}),(0,e.jsx)(f,{open:!!p,onOpenChange:()=>s(null),children:(0,e.jsxs)(y,{"aria-describedby":"delete-type-description",children:[(0,e.jsxs)(b,{children:[(0,e.jsx)(D,{children:"\xBFEliminar tipo de servicio?"}),(0,e.jsx)(B,{id:"delete-type-description",children:"Esta acci\xF3n es irreversible. \xBFDeseas continuar?"})]}),(0,e.jsxs)(N,{children:[(0,e.jsx)(o,{onClick:()=>s(null),variant:"outline",children:"Cancelar"}),(0,e.jsx)(o,{onClick:J,variant:"destructive",children:"Eliminar"})]})]})})]})}export{F as default};
