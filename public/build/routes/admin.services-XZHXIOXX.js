import{a as T}from"/build/_shared/chunk-LXQEBCO3.js";import{a as v,b,c as y,d as S,e as N,f as I,g as w,h as c}from"/build/_shared/chunk-JB55QAS3.js";import{c as l}from"/build/_shared/chunk-MGHLVMKF.js";import{a as B}from"/build/_shared/chunk-2MFZW4W2.js";import"/build/_shared/chunk-AMZSOOKO.js";import"/build/_shared/chunk-NKGL3J4W.js";import{l as E,m as L,q as z}from"/build/_shared/chunk-LU4WXESO.js";import{h as k}from"/build/_shared/chunk-2IM6IZL7.js";import{a as X,b as P}from"/build/_shared/chunk-F33EF4G7.js";import{d as f}from"/build/_shared/chunk-2QEWK57A.js";var r=f(X(),1);var e=f(P(),1);function F(){let[$,C]=(0,r.useState)([]),[j,D]=(0,r.useState)(!0),[i,o]=(0,r.useState)(null),[p,d]=(0,r.useState)(null),[O,H]=(0,r.useState)([]),[x,U]=(0,r.useState)(""),[m,J]=k(),[u,R]=(0,r.useState)(Number(m.get("page"))||1),[g,G]=(0,r.useState)(Number(m.get("pageSize"))||10),h=async()=>{D(!0);try{let a=await(await fetch("http://localhost:5055/api/v1/services",{credentials:"include"})).json();C(a)}catch(t){console.error("Error al cargar servicios",t)}finally{D(!1)}},q=async()=>{try{let a=await(await fetch("http://localhost:5055/api/serviceTypes",{credentials:"include"})).json();H(a)}catch(t){console.error("Error al cargar tipos de servicio",t)}},K=async(t,a)=>{try{await fetch(`http://localhost:5055/api/v1/services/${t}/status`,{method:"PATCH",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({isActive:!a})}),C(s=>s.map(n=>n.id===t?{...n,isActive:!a}:n))}catch(s){console.error("Error al cambiar estado",s)}},M=async()=>{if(!i)return;let t=i.id?"PUT":"POST",a=i.id?`http://localhost:5055/api/v1/services/${i.id}`:"http://localhost:5055/api/v1/services",s=JSON.stringify({serviceTypeId:i.serviceTypeId,title:i.title,description:i.description,image:i.image,isActive:i.isActive});try{let n=await fetch(a,{method:t,headers:{"Content-Type":"application/json"},credentials:"include",body:s});if(n.ok)h(),o(null);else{let W=await n.json();console.error("Error al guardar servicio",W)}}catch(n){console.error("Error en la petici\xF3n",n)}},Q=async()=>{if(p)try{await fetch(`http://localhost:5055/api/v1/services/${p}`,{method:"DELETE",credentials:"include"}),d(null),h()}catch(t){console.error("Error al eliminar servicio",t)}};(0,r.useEffect)(()=>{h(),q()},[]);let A=$.filter(t=>t.title.toLowerCase().includes(x.toLowerCase())),V=A.slice((u-1)*g,u*g);return(0,r.useEffect)(()=>{let t=Number(m.get("pageSize"))||10;G(t)},[m]),(0,e.jsxs)("div",{children:[j?(0,e.jsx)("p",{className:"text-4xl",children:"Cargando servicios..."}):(0,e.jsxs)(e.Fragment,{children:[(0,e.jsxs)("div",{className:"flex justify-between items-center mb-4",children:[(0,e.jsxs)(l,{onClick:()=>o({title:"",description:"",image:"",serviceTypeId:0,isActive:!0}),className:"flex gap-2 items-center",children:[(0,e.jsx)(L,{size:18})," Nuevo"]}),(0,e.jsx)(v,{placeholder:"Buscar por t\xEDtulo...",value:x,onChange:t=>U(t.target.value),className:"w-1/2"})]}),(0,e.jsx)("div",{className:"overflow-auto",children:(0,e.jsxs)("table",{className:"min-w-full bg-white rounded shadow dark:bg-neutral-600",children:[(0,e.jsx)("thead",{className:"bg-gray-100",children:(0,e.jsxs)("tr",{className:"dark:text-black",children:[(0,e.jsx)("th",{className:"p-2 text-left",children:"T\xEDtulo"}),(0,e.jsx)("th",{className:"p-2 text-left",children:"Tipo"}),(0,e.jsx)("th",{className:"p-2 text-left",children:"Estado"}),(0,e.jsx)("th",{className:"p-2 text-left",children:"Acciones"})]})}),(0,e.jsx)("tbody",{children:V.map(t=>(0,e.jsxs)("tr",{className:"border-t",children:[(0,e.jsx)("td",{className:"p-2 text-left",children:t.title}),(0,e.jsx)("td",{className:"p-2 text-left",children:t.serviceTypeName}),(0,e.jsx)("td",{className:"p-2 text-left",children:(0,e.jsx)(T,{checked:t.isActive,onChange:()=>K(t.id,t.isActive),className:`${t.isActive?"bg-green-500":"bg-gray-300"} relative inline-flex h-6 w-11 items-center rounded-full transition-colors`,children:(0,e.jsx)("span",{className:`${t.isActive?"translate-x-6":"translate-x-1"} inline-block h-4 w-4 transform rounded-full bg-white transition-transform`})})}),(0,e.jsxs)("td",{className:"p-2 flex gap-2",children:[(0,e.jsx)(l,{variant:"outline",size:"sm",onClick:()=>o(t),children:(0,e.jsx)(E,{size:16})}),(0,e.jsx)(l,{variant:"destructive",size:"sm",onClick:()=>d(t.id),children:(0,e.jsx)(z,{size:16})})]})]},t.id))})]})})]}),(0,e.jsx)(B,{currentPage:u,totalItems:A.length,pageSize:g,onPageChange:t=>{R(t),J(a=>{let s=new URLSearchParams(a);return s.set("page",String(t)),s})}}),(0,e.jsx)(b,{open:!!i,onOpenChange:()=>o(null),children:(0,e.jsxs)(y,{className:"max-h-[90vh] overflow-auto max-w-[40rem]",children:[(0,e.jsx)(S,{children:(0,e.jsx)(N,{children:i?.id?"Editar Servicio":"Nuevo Servicio"})}),(0,e.jsxs)("form",{className:"space-y-4",children:[(0,e.jsxs)("div",{children:[(0,e.jsx)(c,{htmlFor:"title",children:"T\xEDtulo"}),(0,e.jsx)(v,{id:"title",value:i?.title||"",onChange:t=>o(a=>({...a,title:t.target.value}))})]}),(0,e.jsxs)("div",{children:[(0,e.jsx)(c,{htmlFor:"description",children:"Descripci\xF3n"}),(0,e.jsx)("textarea",{id:"description",rows:4,className:"w-full border border-gray-300 rounded p-2 bg-white",value:i?.description||"",onChange:t=>o(a=>({...a,description:t.target.value}))})]}),(0,e.jsxs)("div",{children:[(0,e.jsx)(c,{htmlFor:"image",children:"Imagen (URL)"}),(0,e.jsx)(v,{id:"image",value:i?.image||"",onChange:t=>o(a=>({...a,image:t.target.value}))})]}),(0,e.jsxs)("div",{children:[(0,e.jsx)(c,{htmlFor:"serviceType",children:"Tipo de Servicio"}),(0,e.jsxs)("select",{id:"serviceType",value:i?.serviceTypeId||0,onChange:t=>o(a=>({...a,serviceTypeId:Number(t.target.value)})),className:"w-full border border-gray-300 rounded p-2 bg-white",children:[(0,e.jsx)("option",{value:0,children:"Seleccionar tipo"}),O.map(t=>(0,e.jsx)("option",{value:t.id,children:t.name},t.id))]})]}),(0,e.jsxs)("div",{children:[(0,e.jsx)(c,{htmlFor:"isActive",children:"Activo"}),(0,e.jsx)(T,{checked:i?.isActive??!0,onChange:()=>o(t=>({...t,isActive:!t.isActive})),className:`${i?.isActive?"bg-green-500":"bg-gray-300"} relative inline-flex h-6 w-11 items-center rounded-full transition-colors`,children:(0,e.jsx)("span",{className:`${i?.isActive?"translate-x-6":"translate-x-1"} inline-block h-4 w-4 transform rounded-full bg-white transition-transform`})})]})]}),(0,e.jsxs)(w,{children:[(0,e.jsx)(l,{variant:"outline",onClick:()=>o(null),children:"Cancelar"}),(0,e.jsx)(l,{onClick:M,children:"Guardar"})]})]})}),(0,e.jsx)(b,{open:!!p,onOpenChange:()=>d(null),children:(0,e.jsxs)(y,{"aria-describedby":"delete-service-description",children:[(0,e.jsxs)(S,{children:[(0,e.jsx)(N,{children:"\xBFEliminar servicio?"}),(0,e.jsx)(I,{id:"delete-service-description",children:"Esta acci\xF3n es irreversible. \xBFDeseas continuar?"})]}),(0,e.jsxs)(w,{children:[(0,e.jsx)(l,{onClick:()=>d(null),variant:"outline",children:"Cancelar"}),(0,e.jsx)(l,{onClick:Q,variant:"destructive",children:"Eliminar"})]})]})})]})}export{F as default};
